{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}

{% block stylesheets %}
	<link rel="stylesheet" href="{% static 'css/base-ABM.css' %}">
    {% block more-stylesheets %}
    {% endblock %}
{% endblock %}

{% block title %}
{% endblock %}

{% block content %}

    <div class="container-fluid panel-grid">
        <div class="col-xs-12 {% block ancho-panel %}{% endblock %}">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="pull-left">
                        <h3 class="panel-title">
                            {% block panel-title-ABM %}
                            {% endblock %}
                        </h3>

                    </div>
                    <div class="btn-group btn-group-xs pull-right">
                        <a class="btn btn-success" href="{% block url-add %} {% endblock %}" id="alta">
                            <span class="glyphicon glyphicon-plus"></span>  Alta
                        </a>
                        {% block btn-modificar %}
                            <a class="btn btn-warning hidden" id="modificar">
                                <span class="glyphicon glyphicon-edit"></span>  Modificaci√≥n
                            </a>
                        {% endblock %}
                        {% block btn-baja %}
                            <a class="btn btn-danger hidden" id="baja">
                                <span class="glyphicon glyphicon-minus"></span>  Baja
                            </a>
                        {% endblock %}

                        {% block more-buttons %}
                        {% endblock %}
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div class="panel-body">
                    {% block form-busqueda %}
                        <form method="GET" class="form-inline pull-right">
                            <div class="form-group">

                                {%block filtro %}

                                <label for="razonSocial" >Buscar:</label>
                                <input class="filtro" id="razonSocial" name="razonSocial" value="{{filtros.razonSocial}}" placeholder=" Razon Social" autofocus>

                                <button class="btn btn-danger btn-sm" type="submit" value="Filtrar" id="btn-filtrar">Filtrar</button>
                                <button class="btn btn-primary btn-sm" type="button"  id="btn-limpiar">Limpiar</button>

                                {% endblock %}

                            </div>
                        </form>
                    {% endblock %}
                    {% block grid %}
                    {% endblock %}
                </div>
                <div class="panel-footer">
                    <span class="text-left text-info" style="font-family: 'sans, sans-serif'; font-size: 16px;">
                        {% block cantidad-elementos %}{% endblock %}
                    </span>
                </div>
            </div>
        </div>
    </div>


    {% block modal-baja %}
    <!-- Modal modal-baja -->
    <div class="modal fade" id="modal-baja" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    {% block modal-baja-title %}{% endblock %}
                </div>
                <div class="modal-body">
                    {% block modal-baja-texto %}{% endblock %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <a class="btn btn-primary confirmar">Confirmar</a>
                </div>
            </div>
            <!-- modal-content -->
        </div>
        <!-- end modal-dialog -->
    </div>
    <!-- end modal ...-->
    {% endblock %}

    <!-- Bloque para agregar mas contenido HTML -->
    {% block more-content %}
    {% endblock %}

{% endblock %}

{% block scripts %}
    <script src="{% static 'js/utils.js' %}"></script>
    <script>
    $(function() {
        /* recupero todos los botones para poder mostrarlos y ocultarlos*/
        var id_botones = [];
        var $botones = $(".panel-heading a");
        for(var i = 1; i < $botones.length; i++){
            id_botones.push("#" + $botones[i].attributes.id.value);
        }

        $(".filtro").change(function(e) {
            $(this).closest("form").submit();
        });

        $(".clickeable").click(function(e) {
            select_row_table(this);
            ocultarElementos(id_botones, false);
            e.stopPropagation();
        });
        
        $("#alta").click(function(e){
            e.stopPropagation();
        });

        function limpiar(e) {
            $("tr").removeClass("active");
            ocultarElementos(id_botones, true);
            id = null;
        }

        $(document).keyup(function(e){
            if(e.keyCode == 27){
                limpiar();
            }
        });

        $(document).on("click", limpiar);

        $("#btn-limpiar").click(function(e){
            $("form input").val("");
            e.stopPropagation();
        });

        $("#selectEstado").on('change',function() {
            $("#btn-filtrar").click();
        });

        
    });
    </script>
    {% block more-scripts %}{% endblock %}
{% endblock %}

