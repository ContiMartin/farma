{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}

{% block stylesheets %}
	<link rel="stylesheet" href="{% static 'css/organizaciones.css' %}">
{% endblock %}

{% block title %}
{% endblock %}

{% block content %}

    <div class="container-fluid panel-grid">
        <div class="col-xs-12">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="pull-left">
                        {% block panel-title-organizacion %}
                        {% endblock %}
                    </div>
                    <button class="btn btn-danger btn-xs pull-right hidden" id="baja" type="button"><span class="glyphicon glyphicon-minus"></span>  Baja</button>
                    <button class="btn btn-warning btn-xs pull-right hidden" id="modificar" type="button"><span class="glyphicon glyphicon-cog"></span>  Modificaci√≥n</button>
                    <button class="btn btn-success btn-xs pull-right" type="button" data-toggle="modal" data-target="#modal-alta"><span class="glyphicon glyphicon-plus"></span>  Alta</button>
                    <div class="clearfix"></div>
                </div>
                <div class="panel-body">
                    <form method="GET" class="form-inline pull-right">
                        <div class="form-group">
                            <label for="razonSocial" >Buscar:</label>
                            <input class="filtro" id="razonSocial" name="razonSocial" value="{{filtros.razonSocial}}" placeholder=" Razon Social">
                        </div>
                    </form>
                    {% block grid %}
                    {% endblock %}
                </div>
            </div>
        </div>
    </div>

    {% block modal-alta %}
    <!-- Modal modal-alta -->
    <div class="modal fade" id="modal-alta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    {% block modal-alta-title %}{% endblock %}
                </div>
                <div class="modal-body">
                    {% block modal-alta-body %}{% endblock %}
                </div>
            </div>
            <!-- modal-content -->
        </div>
        <!-- end modal-dialog -->
    </div>
    <!-- end modal ...-->
    {% endblock %}

    {% block modal-modificar %}
    <!-- Modal modal-alta -->
    <div class="modal fade" id="modal-modificar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    {% block modal-modificar-title %}{% endblock %}
                </div>
                <div class="modal-body">
                    {% block modal-modificar-body %}{% endblock %}
                </div>
            </div>
            <!-- modal-content -->
        </div>
        <!-- end modal-dialog -->
    </div>
    <!-- end modal ...-->
    {% endblock %}

    {% block modal-baja %}
    <!-- Modal modal-baja -->
    <div class="modal fade" id="modal-baja" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    {% block modal-baja-title %}{% endblock %}
                </div>
                <div class="modal-body">
                    {% block modal-baja-texto %}{% endblock %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <a class="btn btn-primary confirmar">Confirmar</a>
                </div>
            </div>
            <!-- modal-content -->
        </div>
        <!-- end modal-dialog -->
    </div>
    <!-- end modal ...-->
    {% endblock %}

{% endblock %}

{% block scripts %}
    <script src="{% static 'js/utils.js' %}"></script>
    <script>
    $(function() {
        var id;
        $(".filtro").change(function(e) {
            $(this).closest("form").submit();
        });

        $(".clickeable").click(function(e) {
            id = select_row_table(this);
            hidden_show(["#modificar", "#baja"], false);
            e.stopPropagation();
        });

        $("#modificar").click(function(e) {
            if (id) {
                var url = "/farmacias/modify/" + id + "/";
                var $modal = $("#modal-modificar");
                var $guardar = $(".guardar", $modal);
                $modal.modal("show");
                $guardar.attr("href", url);
            }
        });

        function limpiar(e) {
            $("tr").removeClass("active");
            hidden_show(["#modificar", "#baja"], true);
            id = null;
        }

        $(document).keyup(function(e){
            if(e.keyCode == 27){
                limpiar();
            }
        });

        $(document).on("click", limpiar);
        {% block more-scripts %}{% endblock %}
    });
    </script>

{% endblock %}

